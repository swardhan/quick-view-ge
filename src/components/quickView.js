import React, { Component } from 'react';import closePopup from '../actions/closePopup.js';import axios from 'axios';import './quickview.css';import './popup.css';class QuickView extends Component {    constructor(props){        super(props);        this.state = {            index: props.index,            product: props.products[props.index],            micro_images: [],            medium_images: [],            current_image: '',        };        this.handleMicroClick = this.handleMicroClick.bind(this);    }    fetchProductAndSetState(product_id){        let temp_id = product_id.split('.')[2];        let url = 'https://dev.goodearth.in/myapi/products/'+temp_id;        let arr = [];        axios.get(url)            .then((response) => {                let micro_url = response.data.images[0].product_image.replace("Medium", "Micro");                arr.push(micro_url);                response.data.sliderimages.forEach(function(image){                    arr.push(image.product_image);                });                return arr;            })            .then((arr) => {                let medium_arr = [];                arr.forEach(function(micro_url){                    medium_arr.push(micro_url.replace('Micro', 'Medium'));                })                this.setState({                    micro_images: arr,                    medium_images: medium_arr,                    current_image: medium_arr[0]                })            })    }    handleMicroClick = (index) => {        return () => { this.setState({            current_image: this.state.medium_images[index]        }); console.log(this.state); }    }    handleNext = () => {        this.setState((prevState) => {            console.log(this.props.store.getState().popup.products.length);            if(prevState.index+1 >= this.props.store.getState().popup.products.length) {                return {                }            }            else {                this.fetchProductAndSetState(this.props.store.getState().popup.products[prevState.index + 1].id);                return {                    index: (prevState.index + 1),                    product: this.props.store.getState().popup.products[prevState.index + 1]                }            }        });    }    componentDidMount(){        this.fetchProductAndSetState(this.state.product.id);    }    handlePrev = () => {        this.setState((prevState) => {            console.log(this.props.store.getState().popup.products);            if((prevState.index - 1)<0) {                return {                    index: prevState.index,                    product: prevState.product                }            }            else {                this.fetchProductAndSetState(this.props.store.getState().popup.products[prevState.index - 1].id);                return {                    index: (prevState.index - 1),                    product: this.props.store.getState().popup.products[prevState.index - 1]                }            }        });    }  render() {      console.log('State: ', this.state);      let images_arr = [];      this.state.children.forEach(function(child, index){      });      this.state.micro_images.forEach(function(image_url, index){          images_arr.push(              <div className='micro_images' key={index} onClick={this.handleMicroClick(index)}>                  <img src={image_url} alt=""/>              </div>          );      }, this);    return(      <div className='modal'>        <div className='modal-inner'>            <div id='quickview'>              <div id='prev' onClick={this.handlePrev}><i className='fa fa-chevron-left fa-5x'></i></div>                <div className='content'>                    <div className="col-md-6">                        <div className="col-md-3 micro_container">                            {                                images_arr.map(function(item){                                        return item                                    }                                )                            }                        </div>                        <div className="col-md-9">                            <img src={this.state.current_image} alt=""/>                        </div>                    </div>                    <div className="col-md-6">                        <div className="row details-text">                            <div className="col-md-12">                                <i className="fa fa-times" onClick={ () => this.props.store.dispatch(closePopup()) }></i>                            </div>                        </div>                        <div className="row details-text">                            <div className="col-md-12 pdp_coll_name">                                <p>SILVERMOON</p>                            </div>                        </div>                        <div className="row details-text">                            <div className="col-md-8 pdp_prod_name">{this.state.product.title}<br/>(Lime)</div>                            <div className="col-md-4 pdp_prod_name price">Rs.{this.state.product.price_inr}</div>                        </div>                        <div className="row details-color">                            <div className="col-md-2 title">COLOUR</div>                            <div className="col-md-2 img"></div>                            <div className="col-md-2 img"></div>                            <div className="col-md-6"></div>                        </div>                        <div className="row details-size">                            <div className="col-md-2 title">SIZE</div>                            <div className="col-md-2 size size-available">2.5"x3.5"</div>                            <div className="col-md-2 size size-selected">4.5"x5.5"</div>                            <div className="col-md-2 size size-unavailable">6.5"x8.5"</div>                            <div className="col-md-2"></div>                            <div className="col-md-2"></div>                        </div>                        <div className="row details-quantity">                            <div className="col-md-2 title">QUANTITY</div>                            <div className="col-md-2">-</div>                            <div className="col-md-2">1</div>                            <div className="col-md-2">+</div>                            <div className="col-md-2"></div>                            <div className="col-md-2"></div>                        </div>                        <div className="row details-cart">                            <div className="col-md-8 cart">ADD TO CART</div>                            <div className="col-md-4 wishlist">ADD TO WISHLIST</div>                        </div>                        <div className="row details-more">                            <div className="col-md-12">VIEW MORE DETAILS</div>                        </div>                    </div>                </div>              <div id='next' onClick={this.handleNext} ><i className='fa fa-chevron-right fa-5x'></i></div>            </div>        </div>      </div>    )  }}export default QuickView;